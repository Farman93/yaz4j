<project>
  <modelVersion>4.0.0</modelVersion>
  <groupId>org.yaz4j</groupId>
  <artifactId>yaz4j</artifactId>
  <name>yaz4j</name>
  <version>1.0-SNAPSHOT</version>
  <packaging>pom</packaging>

  <modules>
    <module>any</module>
  </modules>

  <dependencies>
    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>4.3.1</version>
      <scope>test</scope>
    </dependency>
  </dependencies>

  <build>
    <plugins>
      <plugin>
        <artifactId>maven-antrun-plugin</artifactId>
        <executions>
          <execution>
            <id>generate-sources</id>
            <phase>generate-sources</phase>
            <inherited>false</inherited>
            <configuration>
              <tasks>
                <exec executable="yaz-config" outputproperty="yaz.prefix">
                  <arg value="--prefix" />              
                </exec>
                <echo message="Using yaz prefix: ${yaz.prefix}"/>
                <mkdir dir="target/generated-sources/java/org/yaz4j/jni"/>
                <mkdir dir="target/generated-sources/native" />
                <exec executable="swig">
                  <arg value="-Isrc/main/native" />
                  <arg value="-I${yaz.prefix}/include"/>
                  <arg value="-outdir"/>
                  <arg value="${basedir}/target/generated-sources/java/org/yaz4j/jni"/>
                  <arg value="-package"/>
                  <arg value="org.yaz4j.jni"/>
                  <arg value="-o"/>
                  <arg value="${basedir}/target/generated-sources/native/libyaz4j.cpp"/>
                  <arg value="-c++"/>
                  <arg value="-java"/>
                  <arg value="src/main/swig/libyaz4j.i"/>
                </exec>
              </tasks>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
   </plugins>
  </build>

  <profiles>
    <profile>
      <id>win32</id>
      <activation>
        <property>
          <name>platform</name>
          <value>win32</value>
        </property>
      </activation>
      <modules>
        <module>win32</module>
      </modules>
    </profile>

    <profile>
      <id>linux</id>
      <activation>
        <property>
          <name>platform</name>
          <value>linux</value>
        </property>
      </activation>
      <modules>
        <module>linux</module>
      </modules>
    </profile>
 </profiles>
</project>

