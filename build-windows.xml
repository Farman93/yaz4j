<!-- To build distribution:  ant -f build-windows.xml         -->
<!-- To compile only:        ant compile -f build-windows.xml -->
<!-- To clean dir structure: ant clean -f build-windows.xml   -->

<project name="yaz4j" default="build-dist" basedir=".">

  <description>Build the java side of Yaz4J</description>

  <property name="version" value="0.9.3-windows-x86-32"/>	
  <property name="src" location="src"/>
  <property name="bin" location="bin"/>
  <property name="distributions"  location="distributions"/>
	
  <path id="project.classpath">
    <pathelement location="${bin}"/>
  </path>

  <target name="init">
    <mkdir dir="${bin}"/>
  </target>

  <target name="compile" depends="init" description="compile the source">
    <javac srcdir="${src}" destdir="${bin}">
       <classpath refid="project.classpath"/>
    </javac>
  </target>

  <target name="build-dist" depends="compile" description="generate the distribution">
    <mkdir dir="${distributions}/${version}"/>
    <copy file="libyaz4j/lib/yaz4j.dll" tofile="${distributions}/${version}/yaz4j.dll"/>
    <!-- copy file="dependencies/yaz_3.0.14/bin/yaz3.dll" tofile="${distributions}/${version}/yaz3.dll"/ -->
    <jar jarfile="${distributions}/${version}/yaz4j.jar" basedir="${bin}">
      <manifest>
        <attribute name="Version" value="${version}"/>
        <attribute name="Author" value="Talis Information Ltd"/>
        <attribute name="About" value="Java wrapper for the ZOOM API of YAZ"/>
        <attribute name="Main-Class" value="org.yaz4j.Yaz4jMain"/>
      </manifest>
    </jar>
  </target>

  <target name="clean" description="clean up" >
    <!-- Delete various paths as part of the clean trees -->
    <delete dir="${bin}"/>
    <!-- delete dir="${distributions}/${version}"/ -->    
  </target>

</project>
